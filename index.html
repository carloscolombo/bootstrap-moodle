<!DOCTYPE html>
<html>
<head>
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet">
	<link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'  type='text/css'>
	<style type="text/css">
	body{
		font-family: 'Open Sans', sans-serif;
		padding-top: 40px;
	}
	.text-italic{
		font-style: italic!important;
	}

	.text-center{
		text-align: center;
	}
	.code-container{
		padding: 0 40px;
	}
	#config table tr th{
		width: 25%;	
	}
	</style>
</head>
<body>
	<header></header>
	<div class="container">
		<div class="row">
			<div class="col-lg-12 col-md-12 col-xs-12">
				<section id="title" class="text-center">
					<h1>Bootstrap-Moodle.js<br><small>Create bootstrap modals dynamically.</small></h1>
					<br>
					<a href="/bootstrap-moodle/src/bootstrap-moodle.js" class="btn btn-lg btn-info">Download v1.0.0</a>
				</section>
				<section id="getting-started">
					<h2>Getting Started</h2>
					<hr>
					<h4>Requirements</h4>
					<p>
						Download and add the following scripts to your application.
					</p>
					<ul>
						<li>
							<a href="http://jquery.com/download/" target="_blank">Jquery</a>
						</li>
						<li>
							<a href="http://getbootstrap.com/" target="_blank">Bootstrap</a>
						</li>
					</ul>
					<p>
						or use the following CDN scripts.
					</p>
					<div class="code-container">
						<pre class="pre-scrollable prettyprint linenums lang-javascript" data-source="#cdn"></pre>
						<div id="cdn">
							<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.js"></script>
							<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
						</div>
					</div>
					<br>
					<h4>Support</h4>
					<ul>
						<li>Chrome</li>
						<li>Firefox</li>
						<li>Safari</li>
						<li>IE 9+</li>
					</ul>
				</section>
				<section id="examples">
					<h2>Examples</h2>
					<hr>
					<h4>Default Modal</h4>
					<p>Creates a modal dynamically with default settings, open console and try it out.</p>
					<div class="code-container">
						<h5>JS</h5>
						<pre class="pre-scrollable prettyprint linenums lang-javascript" data-source="#example1"></pre>
						<script id="example1" type="text/html">
							$(function(){
								var moodle = Moodle.create()
								moodle.show();
							});
						</script>
					<br>
					</div>
					<h4>Modal with simple parameters</h4>
					<p>Creates a modal dynamically with some simple settings.</p>
					<div class="code-container">
						<h5>JS</h5>
						<pre class="pre-scrollable prettyprint linenums lang-javascript" data-source="#example2"></pre>
						<script id="example2" type="text/html">
							$(function(){
								var moodle = Moodle.create({
									modal: {
										title: 'Simple Parameters',
										content: '<span class="text-italic">Ooooodles and Mooooodles!</span>'
									}
								})
								moodle.show();
							});
						</script>
					</div>
					<br>
					<h4>Simple click event</h4>
					<p>Provide the selector that you want to trigger the modal event</p>
					<div class="code-container">
						<h5>HTML</h5>
						<pre class="pre-scrollable prettyprint linenums lang-javascript" data-source="#example3-html"></pre>
						<script id="example3-html" type="text/html">
							<button id="my-moodle-button" type="button">Show Moodle</button>
						</script>
						<br>
						<h5>JS</h5>
						<pre class="pre-scrollable prettyprint linenums lang-javascript" data-source="#example3"></pre>
						<script id="example3" type="text/html">
							$(function(){
								moodle.create({
									selector: '#my-moodle-button',
									modal: {
										title: 'Simple Click Event',
										content: '<span class="text-italic">Ooooodles and Mooooodles!</span>'
									}
								});
							});
						</script>
						<br>
						<div class="text-right">
							<button id="example3-button" class="btn btn-primary">Show Moodle</button>
						</div>
					</div>
					<br>
					<p>You can store the Moodle instance and trigger it later programatically. This can also be achieved with Jquery.</p>
					<div class="code-container">
						<h5>JS</h5>
						<pre class="pre-scrollable prettyprint linenums lang-javascript" data-source="#example3-1"></pre>
						<script id="example3-1" type="text/html">
							$(function(){
								// cache instance
								var moodle = moodle.create();

								// ...
								// trigger later via moodle
								moodle.show();

								// or do it via Jquery
								$('#my-moodle-button').trigger('click');

								// hide via moodle 
								moodle.hide();

								// or via Jquery/Bootstrap
								$('.modal').modal('hide');
							});
						</script>
					</div>
					<br>
					<h4>Anchor tags</h4>
					<p>
						When the&nbsp;<strong>selector</strong>&nbsp;is specified to an&nbsp;<code>&lt;a&gt;</code>&nbsp;tag, it will automatically use the href to load in the modal body.
					</p>
					<div class="code-container">
						<h5>HTML</h5>
						<pre class="pre-scrollable prettyprint linenums lang-javascript" data-source="#example4-html"></pre>
						<script id="example4-html" type="text/html">
							<a href="/partial.html" class="btn btn-primary">Anchor Moodle</a>
						</script>
						<br>
						<h5>JS</h5>
						<pre class="pre-scrollable prettyprint linenums lang-javascript" data-source="#example4"></pre>
						<script id="example4" type="text/html">
							$(function(){
								Moodle.create({
									selector: 'a#my-moodle-button'
								})
							});
						</script>
						<br>
						<div class="text-right">
							<a id="example4-button" href="/partial.html" class="btn btn-primary">Anchor Moodle</a>
						</div>
					</div>
					<br>
					<p>
						If you want to override the href and replace it with a specifice URL, just set the&nbsp;<code>url</code>&nbsp;
						property in the&nbsp;<code>loadOptions</code>. This will also cause non&nbsp;<code>&lt;a&gt;</code>&nbsp;tags
						to load url content into the modal body. For more info on&nbsp;<code>loadOptions</code>&nbsp;, please view 
						other examples or check out the&nbsp;<a href="#config">configurations</a>.
					</p>
					<div class="code-container">
						<pre class="pre-scrollable prettyprint linenums lang-javascript" data-source="#example4-1"></pre>
						<script id="example4-1" type="text/html">
							$(function(){
								Moodle.create({
									selector: 'button#my-moodle-button',
									loadOptions:{
										url: '/partial-alt.html'
									}
								})
							});
						</script>
						<div class="text-right">
							<button id="example4-1-button" type="button" class="btn btn-primary">Url Moodle</button>
						</div>
					</div>
					<br>
					<h4>JSON/XML</h4>
					<p>
						When expecting a response with a&nbsp;<code>content-type</code>&nbsp;other than&nbsp;<code>html</code>&nbsp;, the modal body will not be populated. Use the&nbsp;<code>modal-loaded</code>&nbsp;event to fill the content&nbsp;<code>.modal-body</code>&nbsp;.
					</p>
					<div class="code-container">
						<h5>HTML</h5>
						<pre class="pre-scrollable prettyprint linenums lang-javascript" data-source="#example5-html"></pre>
						<script id="example5-html" type="text/html">
							<a href="/data.json" id="my-moodle-button" class="btn btn-primary">JSON Moodle</a>
						</script>
						<br>
						<h5>JSON</h5>
						<pre class="pre-scrollable prettyprint linenums lang-javascript" data-source="#example5-json"></pre>
						<script id="example5-json" type="text/html">
							{
								"id": 10,
								"message": "Whoa, look at dat data."
							}
						</script>
						<br>
						<h5>JS</h5>
						<pre class="pre-scrollable prettyprint linenums lang-javascript" data-source="#example5"></pre>
						<script id="example5" type="text/html">
							$(function(){
								// cache
								var moodle = Moodle.create({
									selector: 'a#my-moodle-button'
								});

								// event listener 
								moodle.$modal.on('modal-loaded', function(e, response){
									// populate .modal-body
									var html = '<h4>User Id: ' + response.id + '</h4><p>' + response.message + '</p>';

									$(this).find('.modal-body').html(html);
								});
							});
						</script>
						<div class="text-right">
							<a href="/data.json" id="example5-button" class="btn btn-primary">JSON Moodle</a>
						</div>
					</div>
					<br>
					<h4>Bootstrap Modal Options</h4>
					<p>
						You can pass bootstrap modal options using the&nbsp;<code>bootstrapOptions</code>&nbsp;option.
					</p>
					<div class="code-container">
						<h5>HTML</h5>
						<pre class="pre-scrollable prettyprint linenums lang-javascript" data-source="#example6-html"></pre>
						<script id="example6-html" type="text/html">
							<button id="my-moodle-button" class="btn btn-primary">Bootstrap Options Moodle</a>
						</script>
						<br>
						<h5>JS</h5>
						<pre class="pre-scrollable prettyprint linenums lang-javascript" data-source="#example6"></pre>
						<script id="example6" type="text/html">
							$(function(){
								// cache
								var moodle = Moodle.create({
									selector: 'button#my-moodle-button',
									modal:{
										title: 'Bootstrap Options',
										content: 'Static backdrop option added!',
										bootstrapOptions:{
											backdrop: 'static'
										}
									}
								});
							});
						</script>
						<div class="text-right">
							<button id="example6-button" class="btn btn-primary">Bootstrap Options Moodle</a>
						</div>
					</div>
					<br>
					<h4>Buttons</h4>
					<p>You can create modal buttons and customize the controls. By default, the close button is provided for you.</p>
					<div class="code-container">
						<h5>HTML</h5>
						<pre class="pre-scrollable prettyprint linenums lang-javascript" data-source="#example7-html"></pre>
						<script id="example7-html" type="text/html">
							<button id="my-moodle-button" class="btn btn-primary">Moodle Custom Buttons</button>
						</script>
						<br>
						<h5>JS</h5>
						<pre class="pre-scrollable prettyprint linenums lang-javascript" data-source="#example7"></pre>
						<script id="example7" type="text/html">
							$(function(){
								// cache
								var moodle = moodle.create({
									selector: 'button#my-moodle-button',
									buttons: [{
										type: 'default',
										css: null,
										action: function(e, moodle){
											moodle.hide();
										},
										content: 'Cancel',
										attr: {
											type: 'button',
											id: 'cancel'
										}
									},
									{
										type: 'sucess',
										css: null,
										action: function(e, moodle){
											$(e.target).addClass('disabled').prop('disabled', true).html('Saving...');

											// simulate post
											setTimeout(function(){
												alert('Saved!');
												moodle.hide();
											}, 1500);
										},
										content: 'Save!',
										attr: {
											type: 'button',
											id: 'save'
										}
									}]
								});
							});
						</script>
						<div class="text-right">
							<button id="example7-button" class="btn btn-primary">Moodle Custom Buttons</button>
						</div>
					</div>
					<br>
					<h4>Dynamically Add buttons</h4>
					<p>You can add buttons dyanmically like so.</p>
					<div class="code-container">
						<h5>HTML</h5>
						<pre class="pre-scrollable prettyprint linenums lang-javascript" data-source="#example8-html"></pre>
						<script id="example8-html" type="text/html">
							<button id="my-moodle-button" class="btn btn-primary">Moodle With Custom Buttons</a>
						</script>
						<br>
						<h5>JS</h5>
						<pre class="pre-scrollable prettyprint linenums lang-javascript" data-source="#example8"></pre>
						<script id="example8" type="text/html">
							$(function(){
								// cache
								var moodle = moodle.create({
									selector: 'button#my-moodle-button',
									modal: {
										title: 'Dynamically Add Buttons',
										content: 'You can download in...&nbsp;<span id="timer"></span>&nbsp;seconds',
										buttons: [{
											type: 'default',
											css: null,
											action: function(e, moodle){
												moodle.hide();
											},
											content: 'Cancel',
											attr: {
												type: 'button',
												id: 'cancel'
											}
										}]
									}
								});

								moodle.$modal.on('shown.bs.modal', function(){
									var id;
									var counter = 10;

									$('#timer').html(counter.toString());

									id = setInterval(function() {
									    counter--;
									    if(counter < 0) {
									        clearInterval(id);
									        moodle.addButtons([{
												type: 'success',
												css: null,
												action: function(e, moodle){
													moodle.hide();
												},
												content: 'Download',
												attr: {
													type: 'button',
													id: 'save'
												}
											}]);
									    } else {
									        $('#timer').html(counter.toString());
									    }
									}, 1000);
									
								});
							});
						</script>
						<div class="text-right">
							<button id="example8-button" class="btn btn-primary">Dynamic buttons</a>
						</div>
					</div>
				</section>
				<section id="config">
					<h2>Configuration</h2>
					<hr>
					<section id="general-options">
						<h4>General Options</h4>
						<table class="table table-condensed table-striped table-hover">
							<thead>
								<tr>
									<th>Option</th>
									<th>Type</th>
									<th>Default</th>
									<th>Description</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td><code>selector</code></td>
									<td>string</td>
									<td><code>null</code></td>
									<td>The element to attach to for the triggering the modal.</td>
								</tr>
								<tr>
									<td><code>modal</code></td>
									<td>object</td>
									<td><a href="#modal-options">Modal Options</a></td>
									<td>Configuration for modal. View&nbsp;<a href="#modal-options">Modal Options</a> for more details.</td>
								</tr>
								<tr>
									<td><code>loadOptions</code></td>
									<td>object</td>
									<td><a href="#modal-options">Load Options</a></td>
									<td>Configuration for loading from external sources via ajax. View&nbsp;<a href="#modal-options">Load Options</a> for more details.</td>
								</tr>
							</tbody>
						</table>
					</section>
					<section id="modal-options">
						<h4>Modal Options</h4>
						<table class="table table-condensed table-striped table-hover">
							<thead>
								<tr>
									<th>Option</th>
									<th>Type</th>
									<th>Default</th>
									<th>Description</th>	
								</tr>
							</thead>
							<tbody>
								<tr>
									<td><code>title</code></td>
									<td>string</td>
									<td><code>'Modal Title'</code></td>
									<td>Sets the HTML content of&nbsp;<code>.modal-title</code>.</td>
								</tr>
								<tr>
									<td><code>content</code></td>
									<td>string</td>
									<td><code>'&lt;p&gt;One fine body...&lt;/p&gt;'</code></td>
									<td>Sets HTML content of&nbsp;<code>.modal-content</code>.</td>
								</tr>
								<tr>
									<td><code>loadingText</code></td>
									<td>string</td>
									<td><code>'&lt;div class="text-center"&gt;Loading...&lt;/div&gt;'</code></td>
									<td>Sets HTML content of&nbsp;<code>.modal-content</code>&nbsp;while waiting for ajax response.</td>
								</tr>
								<tr>
									<td><code>bootstrapOptions</code></td>
									<td>object</td>
									<td><a href="http://getbootstrap.com/javascript/#modals-options">Bootstrap Modal Options</a></td>
									<td>Sets Bootstrap options for a modal. Please visit Bootstrap&nbsp;<a href="http://getbootstrap.com/javascript/#modals-options" target="_blank">documentation</a>&nbsp;for configuration options.</td>
								</tr>
								<tr>
									<td><code>buttons</code></td>
									<td>array</td>
									<td><a href="#button-options">Button Options</a></td>
									<td>Sets the array of buttons in the&nbsp;<code>.modal-footer</code>. By default the close button is provided. Setting this property to&nbsp;<code>.modal-footer</code>&nbsp;will omit all buttons.</td>
								</tr>
							</tbody>
						</table>
					</section>
					<section id="load-options">
						<h4>Load Options</h4>
						<p>When attaching the&nbsp;<code>selector</code>&nbsp;option to an<code>&lt;a&gt;</code>&nbsp;tag in the&nbsp;<a href="#general-options">General Options</a>&nbsp;or specifying&nbsp;<code>url</code>&nbsp;in the&nbsp;<code>loadOptions</code>, it will trigger an ajax call. The ajax configuration can be modified in the&nbsp;<code>loadOptions</code>&nbsp;property. Visit jQuery ajax&nbsp;<a href="http://api.jquery.com/jquery.ajax/" target="_blank">documentation</a>&nbsp;for details on available options.</p>
						<p>These are the ajax defaults.</p>
						<table class="table table-condensed table-striped table-hover">
							<thead>
								<tr>
									<th>Option</th>
									<th>Type</th>
									<th>Default</th>
									<th>Description</th>	
								</tr>
							</thead>
							<tbody>
								<tr>
									<td><code>url</code></td>
									<td>string</td>
									<td><code>null</code></td>
									<td>A string containing the URL to which the request is sent.</td>
								</tr>
							</tbody>
						</table>
					</section>
					<section id="button-options">
						<h4>Button Options</h4>
						<p>By default there is a close button provided for you. The default values will represent this button.</p>
						<table class="table table-condensed table-striped table-hover">
							<thead>
								<tr>
									<th>Option</th>
									<th>Type</th>
									<th>Default</th>
									<th>Description</th>	
								</tr>
							</thead>
							<tbody>
								<tr>
									<td><code>type</code></td>
									<td>string</td>
									<td><code>'default'</code></td>
									<td>Sets the styling of the button. The available options are:&nbsp;<code>'default' 'success' 'warning' 'danger' 'info'</code>.</td>
								</tr>
								<tr>
									<td><code>css</code></td>
									<td>string</td>
									<td><code>null</code></td>
									<td>Adds any additional classes to the button.</td>
								</tr>
								<tr>
									<td><code>action</code></td>
									<td>function</td>
									<td><code>function(e, moodle){ <br> moodle.hide(); <br>}</code></td>
									<td>Callback function for when button is clicked. The function will return two properties, the jquery event and moodle instance.</td>
								</tr>
								<tr>
									<td><code>content</code></td>
									<td>string</td>
									<td><code>'Close'</code></td>
									<td>Sets HTML content for the button.</td>
								</tr>
								<tr>
									<td><code>attr</code></td>
									<td>object</td>
									<td><code>{	<br>type: 'button',<br>id: 'close-modal'<br> }</code></td>
									<td>Sets any additional attributes to the button in the form of a key-value object.</td>
								</tr>
							</tbody>
						</table>
					</section>
				</section>
				<section id="methods">
					<h2>Methods</h2>
					<hr>
					<table class="table table-condensed table-striped table-hover">
						<thead>
							<tr>
								<th>Function</th>
								<th>Parameters</th>
								<th>Description</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td><code>create</code></td>
								<td>object</td>
								<td>Create and returns an instance of moodle. View&nbsp;<a href="#general-options">General Options</a>&nbsp;for option configuration.</td>
							</tr>
							<tr>
								<td><code>init</code></td>
								<td>object</td>
								<td>Initializes moodle object with passed parameters. This method is called immediately after&nbsp;<code>create</code>&nbsp;call.</td>
							</tr>
							<tr>
								<td><code>show</code></td>
								<td>none</td>
								<td>Triggers modal to show.</td>
							</tr>
							<tr>
								<td><code>hide</code></td>
								<td>none</td>
								<td>Triggers modal to hide.</td>
							</tr>
							<tr>
								<td><code>addButtons</code></td>
								<td><code>buttonOptions</code></td>
								<td>Accepts an array of&nbsp;<code>buttonOptions</code>&nbsp;and appends them to the&nbsp;<code>
									.modal-footer</code>.</td>
							</tr>
							<tr>
								<td><code>removeButtons</code></td>
								<td><code>buttonOptions</code></td>
								<td>Accepts an array of&nbsp;<code>buttonOptions</code>&nbsp;and removes them from the&nbsp;<code>
									.modal-footer</code>.</td>
							</tr>
							<tr>
								<td><code>removeAllButtons</code></td>
								<td>none</td>
								<td>Removes all buttons from the modal.</td>
							</tr>
						</tbody>
					</table>
				</section>
				<section id="events">
					<h2>Events</h2>
					<hr>
					<table class="table table-condensed table-striped table-hover">
						<thead>
							<tr>
								<th>Event</th>
								<th>Trigger</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td><code>modal-loaded</code></td>
								<td>This is fired after the&nbsp;<code>loadOptions</code>&nbsp;ajax call has successfully executed. Do not confuse this method with bootstrap's&nbsp;<code>loaded.bs.modal</code>.</td>
							</tr>
						</tbody>
					</table>
				</section>
			</div>
		</div>
		<hr>
		<footer class="text-center text-italic">
			<small class="muted">Bootstrap-Moodle.js by&nbsp;<a href="http://www.carloscolombo.com">Carlos Colombo</a>&nbsp;| MIT license</small>
		</footer>
		<br>
	</div>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
	<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
	<script src="/bootstrap-moodle/src/bootstrap-moodle.js"></script>
	<script type="text/javascript">
	$(function(){
		$('[data-source]').each(function(){
			var $this = $(this),
			$source = $($this.data('source'));

			var text = [];
			$source.each(function(){
				var $s = $(this);
				// debugger;
				if ($s.attr('type') == 'text/html'){
					$s.html().split(/\n/g)[1].replace(/\t/g,' ')					
					text.push($s.html().replace(/(\n)*/, ''));
				} else {
					text.push($s.html().replace(/(\n)/,''));
				}
			});
			$this.text(text.join('\n\n').replace(/\t/g, ' '));
		});

		// // example 3
		// moodle.create({
		// 	selector: '#example3-button',
		// 	modal: {
		// 		title: 'Simple Click Event',
		// 		content: '<span class="text-italic">Ooooodles and Mooooodles!</span>'
		// 	}
		// });

		// // example 4
		// moodle.create({
		// 	selector: '#example4-button'
		// });

		// // example 4-1
		// moodle.create({
		// 	selector: '#example4-1-button',
		// 	loadOptions: {
		// 		url: '/partial-alt.html'
		// 	}
		// });

		// // example 5
		// var example5 = moodle.create({
		// 	selector: '#example5-button'
		// });

		// example5.$modal.on('modal-loaded', function(e, response){
		// 	var html = '<h4>User Id: ' + response.id +'</h4>'
		// 	+ '<p>' + response.message +'</p>';

		// 	$(this).find('.modal-body').html(html);
		// });

		// // example 6
		// moodle.create({
		// 	selector: '#example6-button',
		// 	modal:{
		// 		title: 'Bootstrap Options',
  //         		content: 'Static backdrop option added!',
		// 		bootstrapOptions:{
		// 			backdrop: 'static'
		// 		}
		// 	}
		// });

		// example 7
		var test = moodle.create({
			selector: '#example7-button',
			modal: {
				title: 'Moodle Custom Buttons',
				content: 'Are you sure you want to continue?',
				buttons: [{
					type: 'default',
					css: null,
					action: function(e, moodle){
						moodle.hide();
					},
					content: 'Cancel',
					attr: {
						type: 'button',
						id: 'cancel'
					}
				},
				{
					type: 'success',
					css: null,
					action: function(e, moodle){
						var $button = $(e.target);
						var buttonHtml = $button.html();

						$button.addClass('disabled').prop('disabled', true).html('Saving...');

						// simulate post
						setTimeout(function(){
							alert('Saved!');
							moodle.hide();
							$button.removeClass('disabled').prop('disabled', false).html(buttonHtml);
						}, 1000);
					},
					content: 'Save!',
					attr: {
						type: 'button',
						id: 'save'
					}
				}]
			}
		});

		var example8 = moodle.create({
			selector: '#example8-button',
			modal: {
				title: 'Dynamically Add Buttons',
				content: 'You can download in...&nbsp;<span id="timer"></span>&nbsp;seconds',
				buttons: [{
					type: 'default',
					css: null,
					action: function(e, moodle){
						moodle.hide();
					},
					content: 'Cancel',
					attr: {
						type: 'button'
					}
				}]
			}
		});

		example8.$modal.on('shown.bs.modal', function(){
			var id;
			var counter = 5;

			$('#timer').html(counter.toString());

			id = setInterval(function() {
			    counter--;
			    if(counter < 0) {
			        clearInterval(id);
			        example8.addButtons([{
						type: 'success',
						css: null,
						action: function(e, moodle){
							moodle.hide();
						},
						content: 'Download',
						attr: {
							type: 'button'
						}
					}]);
			    } else {
			        $('#timer').html(counter.toString());
			    }
			}, 1000);
			
		});

	});
	</script>
</body>
</html>
